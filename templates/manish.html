{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Manish-Khata</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="{% static 'index.css' %}" />
  </head>

  <body>
    <div id="conatiner" class="container">
      <div class="tablecover">
        <table class="table tab1">
          <thead>
            <tr>
              <th scope="col">Date</th>
              <th scope="col">Total</th>
              <th scope="col">Desc</th>
            </tr>
          </thead>
          <tbody>
            {% if manish %} {% for m in manish %}
            <tr>
              <td>{{m.date}} {{m.times}}</td>
              <td>{{m.price}}Rs</td>
              <td>{{m.desc}}</td>
            </tr>

            {% endfor %} {% else %}
            <tr>
              <td colspan="3">Date has changed. Start from today...</td>
            </tr>
            {% endif %}
          </tbody>
        </table>

        <div id="mor_wrap" class="mor_wrap">
          <div id="mor" class="mor">
            <div class="d-flex gap-5">
              <h3>Date: {{ date }}</h3>
              <span id="Warbtn" class="btn btn-warning">X</span>
            </div>
            <form action="/manish/" method="post">
              {% csrf_token %}
              <div class="mb-3">
                <label for="exampleInputEmail1" class="form-label">Price</label>
                <input
                  required
                  name="price"
                  type="number"
                  class="form-control"
                  id="exampleInputEmail1"
                  aria-describedby="emailHelp"
                />
              </div>
              <div class="mb-3">
                <label for="exampleInputPassword1" class="form-label"
                  >desc</label
                >
                <input
                  required
                  name="desc"
                  type="text"
                  class="form-control"
                  id="exampleInputPassword1"
                />
              </div>

              <button id="submit" type="submit" class="btn btn-primary">
                Submit
              </button>
            </form>
          </div>
        </div>
      </div>
      <div id="btn" class="btn btn-primary px-5">Add</div>
      <div id="exportbtn" class="btn btn-dark px-5">Export</div>
      <a id="back" href="/manish/" class="btn flex-container my-3 btn-success"
        >Back</a
      >
      <div id="dataform" class="dataform">
        <form action="/manish_export/" method="post">
          {% csrf_token %}
          <div class="d-flex gap-5">
            <h3>Date: {{ date }}</h3>
            <span id="Warbtn2" class="btn btn-warning">X</span>
          </div>

          <div class="mb-3">
            <label for="exampleInputEmail1" class="form-label">from</label>
            <input
              name="from"
              type="date"
              class="form-control"
              id="exampleInputEmail1"
              aria-describedby="emailHelp"
            />
          </div>
          <div class="mb-3">
            <label for="exampleInputEmail1" class="form-label">to</label>
            <input
              name="to"
              type="date"
              class="form-control"
              id="exampleInputEmail1"
              aria-describedby="emailHelp"
            />
          </div>
          <button type="submit" id="downloadbtn" class="btn btn-dark px-5">
            Show
          </button>
        </form>
      </div>
      <p class="text-center">
        <span class="fs-3"
          >Today :<span class="text-success text-center fs-1 fw-bold"
            >{{total_day}}Rs</span
          ></span
        >
      </p>
      <p class="text-center">
        <span class="fs-3"
          >Month :<span class="text-success text-center fs-1 fw-bold"
            >{{total_month}}rs</span
          ></span
        >
      </p>

      <p class="text-danger">Today:-</p>

      {% if avgss|length > 0 %}
      <div id="paymentbox" style="height: 140px" class="paymentbox">
        {% for dess in avgss %}
        <div class="alert alert-success" role="alert">
          <span class="text-danger">{{dess.total_price}}</span> Rs paid for
          <span class="text-danger">{{dess.desc}}</span>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div id="paymentbox" style="height: 0px" class="paymentbox"></div>

      {% endif %}
      <p class="text-success">Montly:-</p>

      <div id="paymentbox2" style="height: 220px:" class="paymentbox">
        {% for dess in avgs %}
        <div class="alert alert-success" role="alert">
          Total <span class="text-danger">{{dess.total_price}}</span> Rs paid
          for
          <span class="text-danger">{{dess.desc}}</span>
        </div>
        {% endfor %}
      </div>
    </div>

    <script>
      let btn = document.getElementById("btn");
      let Warbtn = document.getElementById("Warbtn");
      let exportbtn = document.getElementById("exportbtn");
      let mor = document.getElementById("mor");
      let mor_wrap = document.getElementById("mor_wrap");
      let paymentbox = document.getElementById("paymentbox");
      let paymentbox2 = document.getElementById("paymentbox2");
      let downloadbtn = document.getElementById("downloadbtn");
      let back = document.getElementById("back");

      btn.addEventListener("click", () => {
        mor.style.display = "block";
        mor_wrap.style.display = "flex";
        paymentbox.style.display = "none";
        paymentbox2.style.display = "none";
      });
      exportbtn.addEventListener("click", () => {
        mor_wrap.style.display = "flex";
        dataform.style.display = "block";
        paymentbox.style.display = "none";
        paymentbox2.style.display = "none";
      });
      Warbtn.addEventListener("click", () => {
        mor.style.display = "none";
        mor_wrap.style.display = "none";
        paymentbox.style.display = "block";
        paymentbox2.style.display = "block";
      });
      Warbtn2.addEventListener("click", () => {
        dataform.style.display = "none";
        mor_wrap.style.display = "none";
        paymentbox.style.display = "block";
        paymentbox2.style.display = "block";
      });
      downloadbtn.addEventListener("click", (e) => {
        // e.preventDefault();
        mor_wrap.style.display = "none";
        dataform.style.display = "none";
        paymentbox.style.display = "none";
        paymentbox2.style.display = "block";
        back.style.display = "block";
      });
      back.addEventListener("click", () => {
        back.style.display = "none";
      });
    </script>
  </body>
</html>
